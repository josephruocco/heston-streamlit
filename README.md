# Heston Model Monte Carlo Option Pricer (Streamlit)

An interactive Streamlit application for simulating the Heston stochastic volatility model and
pricing European options via Monte Carlo simulation.

---

## Overview

This project allows users to:

- Simulate asset price and variance paths under the Heston model
- Price European call and put options using Monte Carlo
- Visualize price paths, variance paths, terminal price distributions, and option prices across strikes
- Interactively explore model parameters through a Streamlit interface

Background references:
- https://en.wikipedia.org/wiki/Heston_model
- https://en.wikipedia.org/wiki/Monte_Carlo_methods_in_finance
- https://en.wikipedia.org/wiki/European_option

---

## Model

Under the risk-neutral measure, the Heston model is given by:

 https:
 <?xml version='1.0' encoding='UTF-8'?>
<!-- Generated by CodeCogs with dvisvgm 3.4.3 -->
<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='178.75485pt' height='13.724181pt' viewBox='-.651713 -.301849 178.75485 13.724181'>
<defs>
<path id='g0-0' d='M7.878456-2.749689C8.081694-2.749689 8.296887-2.749689 8.296887-2.988792S8.081694-3.227895 7.878456-3.227895H1.41071C1.207472-3.227895 .992279-3.227895 .992279-2.988792S1.207472-2.749689 1.41071-2.749689H7.878456Z'/>
<path id='g0-112' d='M4.65056 10.221669L2.546451 5.571108C2.462765 5.379826 2.402989 5.379826 2.367123 5.379826C2.355168 5.379826 2.295392 5.379826 2.163885 5.475467L1.028144 6.336239C.872727 6.455791 .872727 6.491656 .872727 6.527522C.872727 6.587298 .908593 6.659029 .992279 6.659029C1.06401 6.659029 1.267248 6.491656 1.398755 6.396015C1.470486 6.336239 1.649813 6.204732 1.78132 6.109091L4.136488 11.285679C4.220174 11.476961 4.27995 11.476961 4.387547 11.476961C4.566874 11.476961 4.60274 11.40523 4.686426 11.237858L10.114072 0C10.197758-.167372 10.197758-.215193 10.197758-.239103C10.197758-.358655 10.102117-.478207 9.958655-.478207C9.863014-.478207 9.779328-.418431 9.683686-.227148L4.65056 10.221669Z'/>
<path id='g2-18' d='M5.296139-6.01345C5.296139-7.232877 4.913574-8.416438 3.93325-8.416438C2.259527-8.416438 .478207-4.913574 .478207-2.283437C.478207-1.733499 .597758 .119552 1.853051 .119552C3.478954 .119552 5.296139-3.299626 5.296139-6.01345ZM1.673724-4.327771C1.853051-5.033126 2.10411-6.03736 2.582316-6.886177C2.976837-7.603487 3.395268-8.177335 3.921295-8.177335C4.315816-8.177335 4.578829-7.84259 4.578829-6.694894C4.578829-6.264508 4.542964-5.66675 4.196264-4.327771H1.673724ZM4.112578-3.969116C3.813699-2.797509 3.56264-2.044334 3.132254-1.291158C2.785554-.681445 2.367123-.119552 1.865006-.119552C1.494396-.119552 1.195517-.406476 1.195517-1.590037C1.195517-2.367123 1.3868-3.180075 1.578082-3.969116H4.112578Z'/>
<path id='g2-20' d='M2.546451-2.988792C2.940971-3.203985 3.383313-3.574595 3.682192-3.825654C4.399502-4.447323 4.662516-4.638605 5.116812-4.817933C5.068991-4.746202 5.057036-4.65056 5.057036-4.566874C5.057036-4.244085 5.332005-4.184309 5.451557-4.184309C5.834122-4.184309 6.049315-4.542964 6.049315-4.770112C6.049315-4.841843 6.025405-5.152677 5.606974-5.152677C4.889664-5.152677 4.184309-4.542964 3.658281-4.100623C2.964882-3.490909 2.618182-3.227895 2.12802-3.072478L2.582316-4.97335C2.582316-5.164633 2.426899-5.272229 2.271482-5.272229C2.163885-5.272229 1.900872-5.236364 1.80523-4.853798L.6934-.418431C.657534-.274969 .657534-.251059 .657534-.179328C.657534-.011955 .789041 .119552 .968369 .119552C1.327024 .119552 1.398755-.191283 1.458531-.442341C1.530262-.6934 2.020423-2.689913 2.044334-2.761644C3.56264-2.689913 4.076712-2.307347 4.076712-1.721544C4.076712-1.637858 4.076712-1.601993 4.040847-1.470486C3.993026-1.243337 3.993026-1.111831 3.993026-1.0401C3.993026-.32279 4.459278 .119552 5.045081 .119552C5.535243 .119552 5.810212-.227148 5.989539-.537983C6.240598-1.004234 6.396015-1.661768 6.396015-1.709589C6.396015-1.769365 6.348194-1.817186 6.276463-1.817186C6.168867-1.817186 6.156912-1.769365 6.109091-1.578082C5.953674-1.004234 5.69066-.119552 5.080946-.119552C4.817933-.119552 4.686426-.274969 4.686426-.6934C4.686426-.920548 4.734247-1.183562 4.782067-1.362889C4.805978-1.482441 4.841843-1.625903 4.841843-1.75741C4.841843-2.84533 3.335492-2.952927 2.546451-2.988792Z'/>
<path id='g2-27' d='M6.073225-4.507098C6.228643-4.507098 6.623163-4.507098 6.623163-4.889664C6.623163-5.152677 6.396015-5.152677 6.180822-5.152677H3.53873C1.745455-5.152677 .454296-3.156164 .454296-1.745455C.454296-.729265 1.111831 .119552 2.187796 .119552C3.598506 .119552 5.140722-1.398755 5.140722-3.19203C5.140722-3.658281 5.033126-4.112578 4.746202-4.507098H6.073225ZM2.199751-.119552C1.590037-.119552 1.147696-.585803 1.147696-1.41071C1.147696-2.12802 1.578082-4.507098 3.335492-4.507098C3.849564-4.507098 4.423412-4.25604 4.423412-3.335492C4.423412-2.917061 4.23213-1.912827 3.813699-1.219427C3.383313-.514072 2.737733-.119552 2.199751-.119552Z'/>
<path id='g2-87' d='M10.795517-6.838356C11.070486-7.304608 11.333499-7.746949 12.050809-7.81868C12.158406-7.830635 12.266002-7.84259 12.266002-8.033873C12.266002-8.16538 12.158406-8.16538 12.12254-8.16538C12.09863-8.16538 12.014944-8.141469 11.225903-8.141469C10.867248-8.141469 10.496638-8.16538 10.149938-8.16538C10.078207-8.16538 9.934745-8.16538 9.934745-7.938232C9.934745-7.830635 10.030386-7.81868 10.102117-7.81868C10.34122-7.806725 10.723786-7.734994 10.723786-7.364384C10.723786-7.208966 10.675965-7.12528 10.556413-6.922042L7.292653-1.207472L6.862267-7.436115C6.862267-7.579577 6.993773-7.806725 7.663263-7.81868C7.81868-7.81868 7.938232-7.81868 7.938232-8.045828C7.938232-8.16538 7.81868-8.16538 7.758904-8.16538C7.340473-8.16538 6.898132-8.141469 6.467746-8.141469H5.846077C5.66675-8.141469 5.451557-8.16538 5.272229-8.16538C5.200498-8.16538 5.057036-8.16538 5.057036-7.938232C5.057036-7.81868 5.140722-7.81868 5.34396-7.81868C5.893898-7.81868 5.893898-7.806725 5.941719-7.07746L5.977584-6.647073L2.881196-1.207472L2.438854-7.376339C2.438854-7.507846 2.438854-7.806725 3.251806-7.81868C3.383313-7.81868 3.514819-7.81868 3.514819-8.033873C3.514819-8.16538 3.407223-8.16538 3.335492-8.16538C2.917061-8.16538 2.47472-8.141469 2.044334-8.141469H1.422665C1.243337-8.141469 1.028144-8.16538 .848817-8.16538C.777086-8.16538 .633624-8.16538 .633624-7.938232C.633624-7.81868 .729265-7.81868 .896638-7.81868C1.458531-7.81868 1.470486-7.746949 1.494396-7.364384L2.020423-.02391C2.032379 .179328 2.044334 .251059 2.187796 .251059C2.307347 .251059 2.331258 .203238 2.438854 .02391L6.001494-6.204732L6.443836-.02391C6.455791 .179328 6.467746 .251059 6.611208 .251059C6.73076 .251059 6.766625 .191283 6.862267 .02391L10.795517-6.838356Z'/>
<path id='g2-100' d='M6.01345-7.998007C6.025405-8.045828 6.049315-8.117559 6.049315-8.177335C6.049315-8.296887 5.929763-8.296887 5.905853-8.296887C5.893898-8.296887 5.308095-8.249066 5.248319-8.237111C5.045081-8.225156 4.865753-8.201245 4.65056-8.18929C4.351681-8.16538 4.267995-8.153425 4.267995-7.938232C4.267995-7.81868 4.363636-7.81868 4.531009-7.81868C5.116812-7.81868 5.128767-7.711083 5.128767-7.591532C5.128767-7.519801 5.104857-7.424159 5.092902-7.388294L4.363636-4.483188C4.23213-4.794022 3.90934-5.272229 3.287671-5.272229C1.936737-5.272229 .478207-3.526775 .478207-1.75741C.478207-.573848 1.171606 .119552 1.984558 .119552C2.642092 .119552 3.203985-.394521 3.53873-.789041C3.658281-.083686 4.220174 .119552 4.578829 .119552S5.224408-.095641 5.439601-.526027C5.630884-.932503 5.798257-1.661768 5.798257-1.709589C5.798257-1.769365 5.750436-1.817186 5.678705-1.817186C5.571108-1.817186 5.559153-1.75741 5.511333-1.578082C5.332005-.872727 5.104857-.119552 4.614695-.119552C4.267995-.119552 4.244085-.430386 4.244085-.669489C4.244085-.71731 4.244085-.968369 4.327771-1.303113L6.01345-7.998007ZM3.598506-1.422665C3.53873-1.219427 3.53873-1.195517 3.371357-.968369C3.108344-.633624 2.582316-.119552 2.020423-.119552C1.530262-.119552 1.255293-.561893 1.255293-1.267248C1.255293-1.924782 1.625903-3.263761 1.853051-3.765878C2.259527-4.60274 2.82142-5.033126 3.287671-5.033126C4.076712-5.033126 4.23213-4.052802 4.23213-3.957161C4.23213-3.945205 4.196264-3.789788 4.184309-3.765878L3.598506-1.422665Z'/>
<path id='g2-116' d='M2.402989-4.805978H3.502864C3.730012-4.805978 3.849564-4.805978 3.849564-5.021171C3.849564-5.152677 3.777833-5.152677 3.53873-5.152677H2.486675L2.929016-6.898132C2.976837-7.065504 2.976837-7.089415 2.976837-7.173101C2.976837-7.364384 2.82142-7.47198 2.666002-7.47198C2.570361-7.47198 2.295392-7.436115 2.199751-7.053549L1.733499-5.152677H.609714C.37061-5.152677 .263014-5.152677 .263014-4.925529C.263014-4.805978 .3467-4.805978 .573848-4.805978H1.637858L.848817-1.649813C.753176-1.231382 .71731-1.111831 .71731-.956413C.71731-.394521 1.111831 .119552 1.78132 .119552C2.988792 .119552 3.634371-1.625903 3.634371-1.709589C3.634371-1.78132 3.58655-1.817186 3.514819-1.817186C3.490909-1.817186 3.443088-1.817186 3.419178-1.769365C3.407223-1.75741 3.395268-1.745455 3.311582-1.554172C3.060523-.956413 2.510585-.119552 1.817186-.119552C1.458531-.119552 1.43462-.418431 1.43462-.681445C1.43462-.6934 1.43462-.920548 1.470486-1.06401L2.402989-4.805978Z'/>
<path id='g2-118' d='M5.463512-4.471233C5.463512-5.224408 5.080946-5.272229 4.985305-5.272229C4.698381-5.272229 4.435367-4.985305 4.435367-4.746202C4.435367-4.60274 4.519054-4.519054 4.566874-4.471233C4.686426-4.363636 4.99726-4.040847 4.99726-3.419178C4.99726-2.917061 4.27995-.119552 2.84533-.119552C2.116065-.119552 1.972603-.729265 1.972603-1.171606C1.972603-1.769365 2.247572-2.606227 2.570361-3.466999C2.761644-3.957161 2.809465-4.076712 2.809465-4.315816C2.809465-4.817933 2.450809-5.272229 1.865006-5.272229C.765131-5.272229 .32279-3.53873 .32279-3.443088C.32279-3.395268 .37061-3.335492 .454296-3.335492C.561893-3.335492 .573848-3.383313 .621669-3.550685C.908593-4.578829 1.374844-5.033126 1.829141-5.033126C1.936737-5.033126 2.139975-5.033126 2.139975-4.638605C2.139975-4.327771 2.008468-3.981071 1.829141-3.526775C1.255293-1.996513 1.255293-1.625903 1.255293-1.338979C1.255293-1.075965 1.291158-.585803 1.661768-.251059C2.092154 .119552 2.689913 .119552 2.797509 .119552C4.782067 .119552 5.463512-3.789788 5.463512-4.471233Z'/>
<path id='g3-40' d='M3.88543 2.905106C3.88543 2.86924 3.88543 2.84533 3.682192 2.642092C2.486675 1.43462 1.817186-.537983 1.817186-2.976837C1.817186-5.296139 2.379078-7.292653 3.765878-8.703362C3.88543-8.810959 3.88543-8.834869 3.88543-8.870735C3.88543-8.942466 3.825654-8.966376 3.777833-8.966376C3.622416-8.966376 2.642092-8.105604 2.056289-6.933998C1.446575-5.726526 1.171606-4.447323 1.171606-2.976837C1.171606-1.912827 1.338979-.490162 1.960648 .789041C2.666002 2.223661 3.646326 3.000747 3.777833 3.000747C3.825654 3.000747 3.88543 2.976837 3.88543 2.905106Z'/>
<path id='g3-41' d='M3.371357-2.976837C3.371357-3.88543 3.251806-5.36787 2.582316-6.75467C1.876961-8.18929 .896638-8.966376 .765131-8.966376C.71731-8.966376 .657534-8.942466 .657534-8.870735C.657534-8.834869 .657534-8.810959 .860772-8.607721C2.056289-7.400249 2.725778-5.427646 2.725778-2.988792C2.725778-.669489 2.163885 1.327024 .777086 2.737733C.657534 2.84533 .657534 2.86924 .657534 2.905106C.657534 2.976837 .71731 3.000747 .765131 3.000747C.920548 3.000747 1.900872 2.139975 2.486675 .968369C3.096389-.251059 3.371357-1.542217 3.371357-2.976837Z'/>
<path id='g3-43' d='M4.770112-2.761644H8.069738C8.237111-2.761644 8.452304-2.761644 8.452304-2.976837C8.452304-3.203985 8.249066-3.203985 8.069738-3.203985H4.770112V-6.503611C4.770112-6.670984 4.770112-6.886177 4.554919-6.886177C4.327771-6.886177 4.327771-6.682939 4.327771-6.503611V-3.203985H1.028144C.860772-3.203985 .645579-3.203985 .645579-2.988792C.645579-2.761644 .848817-2.761644 1.028144-2.761644H4.327771V.537983C4.327771 .705355 4.327771 .920548 4.542964 .920548C4.770112 .920548 4.770112 .71731 4.770112 .537983V-2.761644Z'/>
<path id='g3-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='g1-116' d='M1.761395-3.172105H2.542466C2.693898-3.172105 2.789539-3.172105 2.789539-3.323537C2.789539-3.435118 2.685928-3.435118 2.550436-3.435118H1.825156L2.11208-4.566874C2.14396-4.686426 2.14396-4.726276 2.14396-4.734247C2.14396-4.901619 2.016438-4.98132 1.880946-4.98132C1.609963-4.98132 1.554172-4.766127 1.466501-4.407472L1.219427-3.435118H.454296C.302864-3.435118 .199253-3.435118 .199253-3.283686C.199253-3.172105 .302864-3.172105 .438356-3.172105H1.155666L.67746-1.259278C.629639-1.060025 .557908-.781071 .557908-.669489C.557908-.191283 .948443 .079701 1.370859 .079701C2.223661 .079701 2.709838-1.044085 2.709838-1.139726C2.709838-1.227397 2.638107-1.243337 2.590286-1.243337C2.502615-1.243337 2.494645-1.211457 2.438854-1.091905C2.279452-.70934 1.880946-.143462 1.39477-.143462C1.227397-.143462 1.131756-.255044 1.131756-.518057C1.131756-.669489 1.155666-.757161 1.179577-.860772L1.761395-3.172105Z'/>
<path id='g1-118' d='M3.961146-2.901121C3.961146-3.52279 3.602491-3.52279 3.57061-3.52279C3.379328-3.52279 3.156164-3.315567 3.156164-3.108344C3.156164-2.980822 3.219925-2.925031 3.291656-2.86127C3.474969-2.701868 3.58655-2.478705 3.58655-2.223661C3.58655-1.857036 3.060523-.143462 2.14396-.143462C1.801245-.143462 1.522291-.326775 1.522291-.828892C1.522291-1.267248 1.761395-1.896887 1.952677-2.375093C2.048319-2.630137 2.072229-2.693898 2.072229-2.83736C2.072229-3.267746 1.721544-3.514819 1.354919-3.514819C.565878-3.514819 .239103-2.391034 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.239601 .494147-2.319303C.70137-3.012702 1.044085-3.291656 1.331009-3.291656C1.45056-3.291656 1.522291-3.219925 1.522291-3.028643C1.522291-2.84533 1.45056-2.662017 1.370859-2.462765C.980324-1.458531 .948443-1.195517 .948443-.948443C.948443-.079701 1.657783 .079701 2.11208 .079701C3.435118 .079701 3.961146-2.295392 3.961146-2.901121Z'/>
</defs>
<g id='page1' transform='matrix(1.13 0 0 1.13 -174.44191 -80.795)'>
<use x='153.318427' y='80.199253' xlink:href='#g2-100'/>
<use x='159.40112' y='80.199253' xlink:href='#g2-118'/>
<use x='165.060391' y='81.992516' xlink:href='#g1-116'/>
<use x='171.937373' y='80.199253' xlink:href='#g3-61'/>
<use x='184.362854' y='80.199253' xlink:href='#g2-20'/>
<use x='191.101409' y='80.199253' xlink:href='#g3-40'/>
<use x='195.653734' y='80.199253' xlink:href='#g2-18'/>
<use x='204.090739' y='80.199253' xlink:href='#g0-0'/>
<use x='216.045899' y='80.199253' xlink:href='#g2-118'/>
<use x='221.705169' y='81.992516' xlink:href='#g1-116'/>
<use x='225.261322' y='80.199253' xlink:href='#g3-41'/>
<use x='231.806146' y='80.199253' xlink:href='#g2-100'/>
<use x='237.888839' y='80.199253' xlink:href='#g2-116'/>
<use x='244.772662' y='80.199253' xlink:href='#g3-43'/>
<use x='256.533977' y='80.199253' xlink:href='#g2-27'/>
<use x='263.187432' y='81.992516' xlink:href='#g1-118'/>
<use x='268.095008' y='71.901208' xlink:href='#g0-112'/>
<rect x='278.057679' y='71.423021' height='.478187' width='9.215412'/>
<use x='278.057679' y='80.199253' xlink:href='#g2-118'/>
<use x='283.716949' y='81.992516' xlink:href='#g1-116'/>
<use x='289.265588' y='80.199253' xlink:href='#g2-100'/>
<use x='295.348281' y='80.199253' xlink:href='#g2-87'/>
<use x='308.025621' y='75.263067' xlink:href='#g1-118'/>
<use x='306.399791' y='83.154768' xlink:href='#g1-116'/>
</g>
</svg>![svg](https://github.com/user-attachments/assets/ac90ede5-0041-4b2c-8fb4-f49617a93815)
//latex.codecogs.com/svg.image?dv_t%20=%20\kappa(\theta-v_t)\,dt%20+%20\sigma_v\sqrt{v_t}\,dW_t^v
 
with correlation rho between the Brownian motions.

with correlation \( \rho \) between the Brownian motions.

European option prices are estimated via discounted expected payoffs.

---

## Project Structure

```text
heston-streamlit/
├── app.py
└── heston_core/
    ├── mc.py        # Monte Carlo simulation
    ├── pricing.py  # Pricing utilities
    └── plots.py    # Plot construction
```

## Installation and Usage

```bash
Copy code
pip install streamlit numpy matplotlib
streamlit run app.py
```

### Notes
Monte Carlo estimates converge as the number of paths increases

Variance non-negativity is enforced at each timestep

The codebase is structured for easy extension to calibration or American options
 
